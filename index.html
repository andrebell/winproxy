<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>winproxy by andrebell</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>winproxy</h1>
        <h2>Python module and command line tool to view and change the proxy settings under Windows</h2>
        <a href="https://github.com/andrebell/winproxy" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="a-proxy-selection-tool-for-windows" class="anchor" href="#a-proxy-selection-tool-for-windows" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>A Proxy Selection Tool for Windows</h1>

<p>From time to time it is necessary to change the systems proxy settings. This
can be due to network changes or to test software with internet access on
different proxies or proxy settings. However, always walking through the
Windows system dialog and manually changing the settings is a tedious task.</p>

<p>Therefore, this small python project enables the quick change of the proxy
settings either programmatically by using the provided module functions, or
from the command line, by calling the command line scripts, that are part of
this project as well.</p>

<h2>
<a id="the-command-line-tool" class="anchor" href="#the-command-line-tool" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Command Line Tool</h2>

<p>The proxy settings in Windows are basically given by four values:</p>

<ul>
<li>ProxyEnable</li>
<li>ProxyHttp11</li>
<li>ProxyServer</li>
<li>ProxyOverride</li>
</ul>

<p>If ProxyEnable is set to 0 no proxy will be used and if it is set to 1 the proxy
settings specified by the other values are in use.</p>

<p>Every value can be set individually or in combination with the "winproxy set"
command. E.g., to set the server value specifically for http you can call</p>

<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\&gt;</span> winproxy <span class="pl-c1">set</span> --http proxyserver:port</pre></div>

<p>Setting a proxy server for all protocols to 10.0.0.1 on port 8080 except for the
local network and enable the proxy is achieved by</p>

<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\&gt;</span> winproxy <span class="pl-c1">set</span> -e 1 --all 10.0.0.1:8080 -o 10.<span class="pl-k">*</span>.<span class="pl-k">*</span>.<span class="pl-k">*</span></pre></div>

<p>Since turning the proxy on and off is quite common, the command line utility 
provides two convinience calls to turn the proxy on and off.</p>

<p>To turn the proxy on you have to call</p>

<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\&gt;</span> winproxy on</pre></div>

<p>from the command prompt and to turn the proxy off you have to run</p>

<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\&gt;</span> winproxy off</pre></div>

<p>respectively. You may want to display the current proxy settings by</p>

<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\&gt;</span> winproxy view</pre></div>

<p>If you do have man proxy exceptions (overrides), you can limit the number of
proxy exceptions displayed with the -n option:</p>

<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\&gt;</span> winproxy view -n 5    <span class="pl-c"># Display only the first 5 exceptions</span></pre></div>

<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\&gt;</span> winproxy view -n 0    <span class="pl-c"># Don't display proxy exceptions at all</span></pre></div>

<p>The full documentation of the command line interface will be given in the
documentation [TODO: Add Doc and link]</p>

<h2>
<a id="the-python-api" class="anchor" href="#the-python-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Python API</h2>

<p>The python API for accessing and changing the proxy settings in windows is
build around a class called ProxySetting. By default, every new object of this
class is initialized with empty default values.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> <span class="pl-k">from</span> winproxy <span class="pl-k">import</span> ProxySetting
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> p <span class="pl-k">=</span> ProxySetting()
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> p.display()
ProxyEnable: <span class="pl-c1">False</span>
ProxyHttp11: <span class="pl-c1">True</span>
ProxyServer: 
ProxyOverride:</pre></div>

<p>To load the current proxy settings from the registry you can use the method
registry_read().</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> p.registry_read()
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> p.display()
ProxyEnable: <span class="pl-c1">True</span>
ProxyHttp11: <span class="pl-c1">True</span>
ProxyServer: <span class="pl-c1">10.0</span>.0.1:<span class="pl-c1">8080</span>
ProxyOverride: 
<span class="pl-k">-</span> <span class="pl-k">&lt;</span>local<span class="pl-k">&gt;</span></pre></div>

<p>You may change the settings using the properties enable, http11, server, and
override, which can directly be set with a bool, bool, string or dictionary, 
and a list respectively.</p>

<p>To give an example, setting the proxy server to new settings for http and
https, one could write</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> p.server <span class="pl-k">=</span> <span class="pl-c1">dict</span>(<span class="pl-v">http</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>10.0.0.1:8080<span class="pl-pds">'</span></span>, <span class="pl-v">https</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>10.0.0.1:8081<span class="pl-pds">'</span></span>)
<span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> p.display()
ProxyEnable: <span class="pl-c1">True</span>
ProxyHttp11: <span class="pl-c1">True</span>
ProxyServer: http<span class="pl-k">=</span><span class="pl-c1">10.0</span>.0.1:<span class="pl-c1">8080</span>;https<span class="pl-k">=</span><span class="pl-c1">10.0</span>.0.1:<span class="pl-c1">8081</span>
ProxyOverride:
<span class="pl-k">-</span> <span class="pl-k">&lt;</span>local<span class="pl-k">&gt;</span></pre></div>

<p>Writing the settings to the registry is achieved with the method registry_write.</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">&gt;&gt;</span><span class="pl-k">&gt;</span> p.registry_write()</pre></div>

<p>The full documentation of the command line interface will be given in the
documentation [TODO: Add Doc and link]</p>

<h2>
<a id="change-log" class="anchor" href="#change-log" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Change Log</h2>

<h3>
<a id="040a1" class="anchor" href="#040a1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>0.4.0a1</h3>

<ul>
<li>Changed winproxy set command line behaviour to only write those values to the
registry, that have been provided as parameter and leave all others as is.
This is way more flexible to use.</li>
<li>Added some short, tutorial-like documentation for the command line.</li>
</ul>

<h3>
<a id="030a1" class="anchor" href="#030a1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>0.3.0a1</h3>

<ul>
<li>Added a first draft of the set command</li>
<li>The winproxy view command was broken if

<ul>
<li>no overrides were set at all</li>
<li>less overrides were set, than should be shown at most</li>
</ul>
</li>
<li>The override list may contain not only ';' separated proxies, but also ','
separated ones. This may even be mixed. Also, there may be whitespace in the
Text. This all is now corrected for, i.e., setting override through the
ProxySettings API will always normalize the string to ';' delimited proxies.</li>
<li>Missing registry values fall back to sensible defaults</li>
</ul>

<h3>
<a id="020a1" class="anchor" href="#020a1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>0.2.0a1</h3>

<ul>
<li>Added the "winproxy cpl" to the command line to open the Windows Internet
Settings dialog</li>
<li>Added a change log to the README</li>
</ul>

<h3>
<a id="010a1" class="anchor" href="#010a1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>0.1.0a1</h3>

<ul>
<li>Basic ProxySettings class for the Python API</li>
<li>Command line with "winproxy on|off|view" to

<ul>
<li>turn the proxy on</li>
<li>turn the proxy off</li>
<li>display the current proxy settings</li>
</ul>
</li>
</ul>

<h2>
<a id="authors" class="anchor" href="#authors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authors</h2>

<p>Andre Alexander Bell <a href="mailto:winproxy@andre-bell.de">winproxy@andre-bell.de</a></p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/andrebell/winproxy/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/andrebell/winproxy/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/andrebell/winproxy"></a> is maintained by <a href="https://github.com/andrebell">andrebell</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
